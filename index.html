<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fantasy Premier League Stats</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Fantasy Premier League Stats & Analysis</h1>
            <p class="subtitle">Player statistics and expected values based on last 4 games of current season</p>
        </header>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Loading FPL data...</p>
        </div>

        <div class="dashboard" id="dashboard" style="display: none;">
            <div class="controls">
                <div class="search-container">
                    <input type="text" id="searchInput" placeholder="Search players..." class="search-input">
                </div>
                <div class="position-tabs">
                    <button class="tab-button active" data-position="Goalkeepers">Goalkeepers</button>
                    <button class="tab-button" data-position="Defenders">Defenders</button>
                    <button class="tab-button" data-position="Midfielders">Midfielders</button>
                    <button class="tab-button" data-position="Attackers">Attackers</button>
                </div>
                <div class="stats-key-toggle">
                    <button id="toggleStatsKey" class="key-toggle-btn">ðŸ“Š Show Stats Key</button>
                </div>
            </div>

            <div class="stats-key" id="statsKey" style="display: none;">
                <div class="key-header">
                    <h3>ðŸ“Š Statistics Key</h3>
                    <button id="closeStatsKey" class="close-key-btn">âœ•</button>
                </div>
                
                <div class="key-content">
                    <div class="key-section">
                        <h4>Core Statistics (Based on Last 4 Games)</h4>
                        <div class="key-grid">
                            <div class="key-item">
                                <strong>xG:</strong> Expected Goals - Statistical likelihood of scoring based on position, pass, angle etc.
                            </div>
                            <div class="key-item">
                                <strong>xA:</strong> Expected Assists - Statistical likelihood of an assist based on pass, position etc.
                            </div>
                            <div class="key-item">
                                <strong>xGC:</strong> Expected Goals Conceded - Goalkeepers/Defenders only
                            </div>
                            <div class="key-item">
                                <strong>BP:</strong> Bonus Points - Average bonus points earned per game
                            </div>
                            <div class="key-item">
                                <strong>Minutes:</strong> Average minutes played per game
                            </div>
                            <div class="key-item">
                                <strong>Avg Saves:</strong> Average saves per game (Goalkeepers only)
                            </div>
                        </div>
                    </div>

                    <div class="key-section">
                        <h4>Predicted Performance</h4>
                        <div class="key-grid">
                            <div class="key-item">
                                <strong>xPPG:</strong> Expected Points Per Game - Predicted FPL points per game based on expected stats and position-specific scoring
                            </div>
                            <div class="key-item">
                                <strong>Points:</strong> Actual average FPL points per game from last 4 games
                            </div>
                        </div>
                    </div>

                    <div class="key-section">
                        <h4>Value Analysis</h4>
                        <div class="key-grid">
                            <div class="key-item">
                                <strong>Price:</strong> Current FPL price in millions (Â£)
                            </div>
                            <div class="key-item">
                                <strong>Value (Pts/Â£):</strong> Actual points per game divided by price - measures performative value for money over last 4 games
                            </div>
                            <div class="key-item">
                                <strong>xValue (Pts/Â£):</strong> Expected points per game divided by price - measures predicted value for money
                            </div>
                        </div>
                    </div>

                    <div class="key-section">
                        <h4>Fixture Difficulty Rating (FDR)</h4>
                        <div class="key-grid">
                            <div class="key-item">
                                <strong>pFDR:</strong> Past Fixture Difficulty Rating - Average difficulty of last 4 fixtures (1=easiest, 5=hardest)
                            </div>
                            <div class="key-item">
                                <strong>fFDR:</strong> Future Fixture Difficulty Rating - Average difficulty of next 4 fixtures (1=easiest, 5=hardest)
                            </div>
                        </div>
                        <div class="fdr-legend">
                            <span class="fdr-sample fdr-excellent">1-2 Excellent</span>
                            <span class="fdr-sample fdr-good">2-3 Good</span>
                            <span class="fdr-sample fdr-average">3-4 Average</span>
                            <span class="fdr-sample fdr-difficult">4-5 Difficult</span>
                        </div>
                    </div>


                    <div class="key-section">
                        <h4>Color Coding</h4>
                        <div class="color-legend">
                            <div class="color-item">
                                <span class="color-sample value-high"></span>
                                <span>High Value (â‰¥0.7 Pts/Â£)</span>
                            </div>
                            <div class="color-item">
                                <span class="color-sample value-medium"></span>
                                <span>Medium Value (0.4-0.7 Pts/Â£)</span>
                            </div>
                            <div class="color-item">
                                <span class="color-sample value-low"></span>
                                <span>Low Value (<0.4 Pts/Â£)</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="table-container">
                <div class="position-section active" id="Goalkeepers">
                    <h2>Goalkeepers</h2>
                    <div class="table-wrapper">
                        <table class="stats-table" id="goalkeepers-table">
                            <thead>
                                <tr>
                                    <th data-sort="rank">Rank</th>
                                    <th data-sort="name">Player Name</th>
                                    <th data-sort="xa">xA</th>
                                    <th data-sort="xgc">xGC</th>
                                    <th data-sort="bp">BP</th>
                                    <th data-sort="minutes">Minutes</th>
                                    <th data-sort="saves">Avg Saves</th>
                                    <th data-sort="xppg">xPPG</th>
                                    <th data-sort="points">Points</th>
                                    <th data-sort="price">Price (Â£)</th>
                                    <th data-sort="value">Value (Pts/Â£)</th>
                                    <th data-sort="xvalue">xValue (Pts/Â£)</th>
                                    <th data-sort="pfdr">pFDR</th>
                                    <th data-sort="ffdr">fFDR</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>

                <div class="position-section" id="Defenders">
                    <h2>Defenders</h2>
                    <div class="table-wrapper">
                        <table class="stats-table" id="defenders-table">
                            <thead>
                                <tr>
                                    <th data-sort="rank">Rank</th>
                                    <th data-sort="name">Player Name</th>
                                    <th data-sort="xg">xG</th>
                                    <th data-sort="xa">xA</th>
                                    <th data-sort="xgc">xGC</th>
                                    <th data-sort="bp">BP</th>
                                    <th data-sort="minutes">Minutes</th>
                                    <th data-sort="xppg">xPPG</th>
                                    <th data-sort="points">Points</th>
                                    <th data-sort="price">Price (Â£)</th>
                                    <th data-sort="value">Value (Pts/Â£)</th>
                                    <th data-sort="xvalue">xValue (Pts/Â£)</th>
                                    <th data-sort="pfdr">pFDR</th>
                                    <th data-sort="ffdr">fFDR</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>

                <div class="position-section" id="Midfielders">
                    <h2>Midfielders</h2>
                    <div class="table-wrapper">
                        <table class="stats-table" id="midfielders-table">
                            <thead>
                                <tr>
                                    <th data-sort="rank">Rank</th>
                                    <th data-sort="name">Player Name</th>
                                    <th data-sort="xg">xG</th>
                                    <th data-sort="xa">xA</th>
                                    <th data-sort="xgc">xGC</th>
                                    <th data-sort="bp">BP</th>
                                    <th data-sort="minutes">Minutes</th>
                                    <th data-sort="xppg">xPPG</th>
                                    <th data-sort="points">Points</th>
                                    <th data-sort="price">Price (Â£)</th>
                                    <th data-sort="value">Value (Pts/Â£)</th>
                                    <th data-sort="xvalue">xValue (Pts/Â£)</th>
                                    <th data-sort="pfdr">pFDR</th>
                                    <th data-sort="ffdr">fFDR</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>

                <div class="position-section" id="Attackers">
                    <h2>Attackers</h2>
                    <div class="table-wrapper">
                        <table class="stats-table" id="attackers-table">
                            <thead>
                                <tr>
                                    <th data-sort="rank">Rank</th>
                                    <th data-sort="name">Player Name</th>
                                    <th data-sort="xg">xG</th>
                                    <th data-sort="xa">xA</th>
                                    <th data-sort="bp">BP</th>
                                    <th data-sort="minutes">Minutes</th>
                                    <th data-sort="xppg">xPPG</th>
                                    <th data-sort="points">Points</th>
                                    <th data-sort="price">Price (Â£)</th>
                                    <th data-sort="value">Value (Pts/Â£)</th>
                                    <th data-sort="xvalue">xValue (Pts/Â£)</th>
                                    <th data-sort="pfdr">pFDR</th>
                                    <th data-sort="ffdr">fFDR</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <footer class="footer">
            <p>Data sourced from Fantasy Premier League API | Last updated: <span id="lastUpdated"></span></p>
        </footer>
    </div>

    <script src="script.js"></script>
</body>
</html>
